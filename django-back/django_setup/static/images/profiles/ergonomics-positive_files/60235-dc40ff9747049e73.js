"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[60235],{60235:function(i,t,e){e.d(t,{Oy:function(){return R},DJ:function(){return F},_Y:function(){return k},av:function(){return I},V9:function(){return Z}});var n=e(26042),r=e(69396),o=e(99534),u=e(36305),s=e(18721),a=e.n(s),c=e(40821),d=e(85672),l=e(331),p=e(19576),v=e(98510),b=e(8062),f=e(36311),S=e(90819),m=e(19805),g=e(93636),y=e(36839),C=e(75957),w=e(14587),U=e(96360),_=[{name:"years",unit:"Y"},{name:"months",unit:"M"},{name:"weeks",unit:"W"},{name:"days",unit:"D"}],x=RegExp(["P"].concat((0,u.Z)(_.map(function(i){var t=i.name,e=i.unit;return"((?<".concat(t,">-?\\d+)").concat(e,")?")}))).join("")),D=function(i){var t=x.exec(i);if(!t||!t.groups)return[];var e=t.groups;return _.reduce(function(i,t){var n=t.name,r=parseInt(e[n],10);return Number.isNaN(r)||i.push({name:n,value:r}),i},[])},h={years:function(i){var t=i.date,e=i.numberOfUnits;return t.setUTCFullYear(t.getUTCFullYear()-e),t},months:function(i){var t=i.date,e=i.numberOfUnits;return t.setUTCMonth(t.getUTCMonth()-e),t},weeks:function(i){var t=i.date,e=i.numberOfUnits;return t.setUTCDate(t.getUTCDate()-7*e),t},days:function(i){var t=i.date,e=i.numberOfUnits;return t.setUTCDate(t.getUTCDate()-e),t}},P=function(i){var t=i.date,e=i.parsedDuration,n=new Date(t);return e.reduce(function(i,t){var e=t.name,n=t.value;return h[e]({date:i,numberOfUnits:n})},n).toISOString()},M=function(i){var t=i.date,e=i.duration;if(!t||!e)return null;try{var n=D(e);if(!n.length)return null;return P({date:t,parsedDuration:n})}catch(r){return null}},T={editorialImageSubscriptions:p.T_F,editorialImageCompSubscriptions:p.fuJ,editorialVideoSubscriptions:p.vWI,editorialVideoCompSubscriptions:p.Ujq,imageSubscriptions:p.xk7,imageCompSubscriptions:[p.Ixo],videoSubscriptions:p.S9k,videoCompSubscriptions:[p.f12],videoPremierSubscriptions:p.XmM,videoPremierSmSubscriptions:p.JI$,videoMediaSubscriptions:p.YVt,videoPlatformSubscriptions:p.Lj9,videoMediaSmSubscriptions:p.ISv,videoPremierSelectSubscriptions:[p.Mbf],videoMediaSelectSubscriptions:[p.Gap],musicSubscriptions:p.xq7,musicCompSubscriptions:p.Yem,sfxSubscriptions:p.dCf,sfxCompSubscriptions:p.uZM,flexSubscriptions:p.zUo,creativeFlowPlusSubscription:p.FLW,apiPlanSubscription:p.px9},A=function(i){var t,e,n,r,o=i.types,u=i.subscription,s=null==u?void 0:null===(t=u.product)||void 0===t?void 0:t.reportingBusinessUnit.toLowerCase().trim();return!a()(u,"redeemableFor")&&((null==u?void 0:null===(e=u.product)||void 0===e?void 0:e.businessUnit)===p.T2Y||(null==u?void 0:null===(n=u.product)||void 0===n?void 0:n.businessUnit)===p.A7v)&&[p.aTO,p.FLW,p.px9].includes(s)?o.includes(s):o.includes(null==u?void 0:u.redeemableFor)||!a()(u,"redeemableFor")&&o.includes(null==u?void 0:null===(r=u.product)||void 0===r?void 0:r.businessUnit)},O=function(i){var t,e,o,u,s,a=i.activeSubscriptions,c=i.subscriptions;if(!c)return{};var d=function(i){return M({date:i.subscriptionExpiration,duration:i.duration})},l=function(i,t){var e=i.startDate;return t.startDate-e},p=a.map(function(i){return(0,r.Z)((0,n.Z)({},i),{startDate:new Date(d(i))})}).sort(l)[0]||c.map(function(i){return(0,r.Z)((0,n.Z)({},i),{startDate:new Date(d(i))})}).sort(l)[0];return p?{orderType:p.purchaseType,subscriptionId:p.id,subscriptionPermissionsExpireDate:p.subscriptionExpiration,autoRenewal:p.autoRenewal?String(p.autoRenewal):void 0,productTextId:null==p?void 0:null===(t=p.product)||void 0===t?void 0:t.name,productLengthTerm:p.duration,productDownloadAllotment:(null===(e=p.product)||void 0===e?void 0:e.downloadCredits)?String(null===(o=p.product)||void 0===o?void 0:o.downloadCredits):void 0,productReportingBusinessUnit:null===(u=p.product)||void 0===u?void 0:u.reportingBusinessUnit,productCategory:null===(s=p.product)||void 0===s?void 0:s.revenueModelDetail}:{}},F=function(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=i.queryParams,e=(void 0===t?{}:t).expiringAfter,r=void 0===e?null:e,o=i.config,u=void 0===o?{}:o,s=(0,m.B)(),a=(0,m.j)().data,l=(0,n.Z)({user:null==a?void 0:a.id,organization:null==a?void 0:a.organizationId},r&&{expiring_after:r}||{}),p=(0,d.ec)({queryParams:l}).formattedUrl;return(0,c.ZP)(s?p:null,function(){return C.uS.get(p,u).then(function(i){return(0,w.O)(i.data)})},{dedupingInterval:v.no})},R=function(i){return i.reduce(function(i,t){return Object.keys(T).forEach(function(e){A({types:T[e],subscription:t})&&i[e].push((0,r.Z)((0,n.Z)({},t),{type:e}))}),i},{editorialImageSubscriptions:[],editorialImageCompSubscriptions:[],editorialVideoSubscriptions:[],editorialVideoCompSubscriptions:[],imageSubscriptions:[],imageCompSubscriptions:[],videoSubscriptions:[],videoCompSubscriptions:[],videoPremierSubscriptions:[],videoPremierSmSubscriptions:[],videoMediaSubscriptions:[],videoMediaSmSubscriptions:[],videoPlatformSubscriptions:[],videoPremierSelectSubscriptions:[],videoMediaSelectSubscriptions:[],musicSubscriptions:[],musicCompSubscriptions:[],sfxSubscriptions:[],sfxCompSubscriptions:[],flexSubscriptions:[],creativeFlowPlusSubscription:[],apiPlanSubscription:[]})},I=function(){var i,t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.expiringAfter,s=e.config,a=(0,m.B)(),c=(0,g.U)(),d=c.isLoading,l=(0,o.Z)(c,["isLoading"]),p=F({queryParams:{expiringAfter:void 0===r?null:r},config:void 0===s?{}:s}),v=p.data,b=p.mutate,S=(0,y.w)().data,C=(void 0===S?{}:S).data;if(d||a&&void 0===v)return{data:void 0};var w=Array.isArray(v)?null==v?void 0:v.filter(function(i){return"active"===i.status}):[],U=Array.isArray(v)?O({activeSubscriptions:w,subscriptions:v}):{};if((0,f.Kc)({userCapabilities:l})){var _=(0,f.cT)({userCapabilities:l,subscriptions:v}),x=_.formattedSubscriptions,D=_.debitableSubscriptionInfo;i=x,t=D}var h=R(i||v||[]),P=(void 0===C?{}:C).attributes,M=(void 0===P?{}:P).lifetimeProducts,T=(void 0===M?null:M)||Array.isArray(v)&&v&&v.length||0;return{data:(0,n.Z)({allSubscriptions:Object.values(h).reduce(function(i,t){return(0,u.Z)(i).concat((0,u.Z)(t))},[]),activeSubscriptions:w,mostRecentSubscription:U,totalNumSubscriptionsAllTime:T,totalNumSubscriptionsActive:w&&w.length||0},h,t),mutate:b}},Z=function(){var i=(0,m.B)(),t=I({});return!1===i?{data:{activeSubscriptions:[],allSubscriptions:[],mostRecentSubscription:void 0,totalNumSubscriptionsActive:0,totalNumSubscriptionsAllTime:0}}:t},k=function(){var i=(0,S.D)({namespace:U.pDn,translationKeys:{autoRenewOnSuccess:"notifications:label_auto_renew_success_on",autoRenewOffSuccess:"notifications:label_auto_renew_success_off",genericFailure:"notifications:label_generic_failure",cancelSubscriptionSuccess:"notifications:subscription_cancellation_success_message",cancelSubscriptionFailure:"notifications:cancellable_error_message"}}).labels,t=(0,b.D)().enqueueSnackbar;return{notifyAutoRenewOnSuccess:function(){t({alertSeverity:l.MR,message:i.autoRenewOnSuccess})},notifyAutoRenewOffSuccess:function(){t({alertSeverity:l.MR,message:i.autoRenewOffSuccess})},notifyCancelSubscriptionSuccess:function(){t({alertSeverity:l.MR,message:i.cancelSubscriptionSuccess})},notifyFailure:function(){t({alertSeverity:l.cM,message:i.genericFailure})},notifyCancelSubscriptionFailure:function(){t({alertSeverity:l.cM,message:i.cancelSubscriptionFailure})}}}},36839:function(i,t,e){e.d(t,{w:function(){return s}});var n=e(40821),r=e(85672),o=e(19805),u=e(75957),s=function(){var i=(0,o.B)(),t=(0,r.sY)().formattedUrl;return(0,n.ZP)(i?t:null,function(){return u.uS.get(t).then(function(i){return i.data})})}}}]);
//# sourceMappingURL=60235-dc40ff9747049e73.js.map